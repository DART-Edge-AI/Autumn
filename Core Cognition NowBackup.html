

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Autumn | Lead Edge Ash Tree Reflex</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<style>

  body {
display: flex;
justify-content: center;
align-items: center;
padding-top: 50px;
background-color: white;
}
.container {
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
max-width: 100%;
}
#googleSheetFrame {
width: 875px;
height: 1200px;
border: none;
}
.row {
display: flex;
flex-direction: row;
align-items: center;
justify-content: center;
max-width: 100%;
--bs-gutter-x: 0;
}
textarea#responseField, #calculationResult {
width: 80%;
height: 150px;
padding: 10px;
margin-top: 20px;
border-radius: 5px;
background-color: whitesmoke;
resize: none;
}
 .buttonContainer {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
 .buttonContainer2 {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
</style>
</head>

<body>

  <div class="container">
    <div class="text-center mb-4">
      <img src="https://static.wixstatic.com/media/2451db_4f17959671e243e780f959689a435b86~mv2.png" alt="Autumn" style="max-width: 70%; height:auto;">
      <br><br><br>
      <h2 style="color: black; font-weight: bold;">Autumn | Lead Edge Ash Tree Reflex</h2>
      <br>
      <button type="button" id="startInstanceBtn" onclick="startUserInstance()" style="background-color: deepskyblue; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Create Ash</button>
      <br>
      <br>
      <h6>Note: Allow a moment for the instance to be created. <br>The Master Sheet is Subject to frequent updates and may not reflect in your current instance.</h6><br>
    </div>

<div id="interactiveElements" style="display: none; align-items: center; justify-content: center;">
  <!-- All interactive elements like forms and buttons go here -->

    <!-- Your forms, buttons, and any other interactive elements here -->


    <div class="container">
      <h4>Autumn | Ash Sculpt</h4>
      <form id="userInputForm">
        <label for="userInput">Enter your Ash:</label>
        <input type="text" id="userInput" name="encodetoAutumn" placeholder="Type something..." style="width: 400px;">
        <button type="button" onclick="submitUserInput()" style="background-color: deepskyblue; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Submit</button>
        <br>
         

      </form>
     <textarea id="responseField" placeholder="Autumn : " rows="4" cols="50" disabled></textarea>
                  <br>
    </div>
      <div class="buttonContainer">
     
    
    <button type="button" onclick="downloadResponse()" style="background-color: deepskyblue; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Download Ash Sculpt</button>
    <br><br>
</div>

    <!-- Algebraic Value Input Form Start -->
    <div class="container">
      <h4>Arc Lake Element Algebra Ash</h4>

      <form id="algebraicValueForm">
        <label for="algebraicValue">Enter Algebraic Ash:</label>
        <input type="text" id="algebraicValue" name="algebraicValue" placeholder="e.g., 2x + 3 = 15" style="width: 400px;">
        <button type="button" onclick="submitAlgebraicValue()" style="background-color: deepskyblue; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Submit</button>
      </form>
      <textarea id="calculationResult" placeholder="Autumn | Calculation Result: " rows="4" cols="50" disabled></textarea>
    </div>
    <br>
          <div class="buttonContainer2">
<button type="button" onclick="downloadAlgebraResponse()" style="background-color: deepskyblue; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Download Algebra Ash</button>
</div>
    <!-- Algebraic Value Input Form End -->
</div>
    <br>
    <iframe id="googleSheetFrame" src="" style="display:none;"></iframe>
    <br>

<script>

function startUserInstance() {
    fetch('https://script.google.com/macros/s/AKfycbzthCAgveCNyw_Cp3WdzHQBbsMYiKHEIZiC9g-RKjaQb4f3tbjma29egU7Jgyyt3LdYFA/exec')
    
    
    
    
    .then(response => response.text())
    .then(sheetUrl => {
        // Assuming the iframe is used to display the sheet and you still want to use it
        document.getElementById('googleSheetFrame').src = sheetUrl; 
        document.getElementById('googleSheetFrame').style.display = 'block'; 

        // Hide the 'Start Your Instance' button
        document.getElementById('startInstanceBtn').style.display = 'none';

        // Now display the interactive elements
        document.getElementById('interactiveElements').style.display = 'block';

        alert("Your personal sheet instance is ready. Please proceed.");
    })
    .catch(error => console.error('Error:', error));
}
    
    
    



function submitUserInput() {
    var userInput = document.getElementById('userInput').value;
    var formData = new FormData();
    formData.append('encodetoAutumn', userInput);

    fetch('https://script.google.com/macros/s/AKfycbwKWaUL1hOF_bXITYJknZfynRTcAvTfb9HASZKs7X8mr6zmdfaStNYBeoMTtaTj1SnTRA/exec', {
        method: 'POST',
        body: formData,
    })
    .then(response => response.text())
    .then(text => {
        document.getElementById('responseField').innerText = text; // Display Autumn's response
        document.getElementById('userInput').value = ''; // Clear the input field
    })
    .catch(error => console.error('Error:', error));
}

function downloadResponse() {
    var response = document.getElementById('responseField').value;
    var blob = new Blob([response], {type: "text/plain"});
    var anchor = document.createElement("a");
    anchor.download = "Autumn.ash";
    anchor.href = window.URL.createObjectURL(blob);
    anchor.style.display = "none"; // Don't show the element
    document.body.appendChild(anchor);
    anchor.click();
    document.body.removeChild(anchor);
}

// Existing submitUserInput and downloadResponse functions

function submitAlgebraicValue() {
    var algebraicValue = document.getElementById('algebraicValue').value;
    var formData = new FormData();
    formData.append('algebraicValue', algebraicValue);
  
    fetch('https://script.google.com/macros/s/AKfycbyGzUHPVK-XQskivvFkc69hnqCMZlkgIrnsLkO5RvzcximrQ6Ds8HEgQ00lpn5uS0NopA/exec', { // Make sure to replace YOUR_SCRIPT_ID with your actual script ID
        method: 'POST',
        body: formData,
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.text(); // Use .text() since we're expecting a text response
      })
      .then(text => {
        document.getElementById('calculationResult').innerText = text; // Display the response in the textarea
        document.getElementById('algebraicValue').value = ''; // Clear the input field
      })
      .catch(error => console.error('Error:', error));
  }
  
function setProcessingState(isProcessing) {
    document.getElementById('submitAlgebraicValue').disabled = isProcessing;
    document.getElementById('calculationResult').placeholder = isProcessing ? "Processing..." : "Autumn | Calculation Result: ";
} 
  function downloadAlgebraResponse() {
    var response = document.getElementById('calculationResult').value;
    var blob = new Blob([response], {type: "text/plain"});
    var anchor = document.createElement("a");
    anchor.download = "Element Algebra.ash";
    anchor.href = window.URL.createObjectURL(blob);
    anchor.style.display = "none"; // Don't show the element
    document.body.appendChild(anchor);
    anchor.click();
    document.body.removeChild(anchor);
}

</script>
</body>
  </html>